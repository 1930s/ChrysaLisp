(import 'inc/func.inc)
(import 'inc/heap.inc)

(def-func 'sys/mem_deinit)
	;get statics
	(f-bind 'sys_mem 'statics r0)
	(vp-cpy-rr r0 r5)

	;free memory heaps
	(vp-cpy-cr mem_block_min_size r6)	;start object size
	(loop-start)
		(f-call 'sys_heap 'deinit '(r5))
		(vp-add-cr hp_heap_size r5)
		(vp-add-rr r6 r6)
	loop_until r6, >, mem_block_max_size
	(vp-ret)

(def-func-end)
