(import 'inc/func.inc)
(import 'inc/syscall.inc)

(def-func 'sys/read_line)
	;inputs
	;r0 = buffer address
	;r1 = buffer size
	;r2 = fd
	;outputs
	;r0 = chars read
	;trashes
	;r0-r3, r5

	vp_cpy r0, r3
	vp_cpy r0, r5
	vp_add r0, r1
	loop_while r5, !=, r1
		sys_read_char r2
		vp_cpy_ub r0, [r5]
		vp_inc r5
	loop_until r0, ==, 10
	vp_cpy r5, r0
	vp_sub r3, r0
	vp_ret

(def-func-end)
