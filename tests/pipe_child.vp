(import 'inc/func.inc)
(import 'inc/math.inc)

;;;;;;;;;;;
; test code
;;;;;;;;;;;

(def-func 'tests/pipe_child)

	(ptr 'msg)
	(ulong 'num)

	(push-scope)

	;read exit command etc
	(func-call 'sys_mail 'mymail '() '(msg))
	(func-call 'sys_mem 'free '(msg))

	;wait a bit
	(func-call 'sys_math 'random '(1000000) '(num))
	(func-call 'sys_task 'sleep '(num + 1000000))

	(pop-scope)
	return

(def-func-end)
